// Generated by CoffeeScript 1.6.2
(function() {
  var HALF_PI, PI, SoundDot, THREEHALVES_PI, TWO_PI, World;

  PI = Math.PI;

  TWO_PI = 2 * Math.PI;

  HALF_PI = Math.PI / 2;

  THREEHALVES_PI = 3 * Math.PI / 2;

  SoundDot = (function() {
    function SoundDot(radius, center, angle, rate) {
      this.radius = radius;
      this.center = center;
      this.angle = angle != null ? angle : HALF_PI;
      this.rate = rate != null ? rate : .05;
      this.circumference = TWO_PI * this.radius;
      this.centerY = this.center.y;
      this.centerX = this.center.x;
    }

    SoundDot.prototype.calculatePosition = function() {
      this.y = this.centerY - this.radius * Math.sin(this.angle);
      return this.x = this.centerX + this.radius * Math.cos(this.angle);
    };

    SoundDot.prototype.update = function(ellapsedTime) {
      var angle, dist;

      dist = this.rate * ellapsedTime;
      angle = TWO_PI * dist / this.circumference;
      this.angle += angle;
      return this.calculatePosition();
    };

    SoundDot.prototype.render = function(graphics) {
      graphics.beginPath();
      graphics.arc(this.x, this.y, 5, 0, TWO_PI, false);
      graphics.fillStyle = "#555555";
      graphics.fill();
      return graphics.stroke();
    };

    return SoundDot;

  })();

  World = (function() {
    function World(width, height) {
      this.width = width;
      this.height = height;
      this.dots = [];
    }

    World.prototype.initialize = function() {
      var center, i, radius, _i, _results;

      center = {
        x: this.width / 2,
        y: this.height / 2
      };
      _results = [];
      for (i = _i = 1; _i <= 10; i = ++_i) {
        radius = 20 * i;
        this.dots.push(new SoundDot(radius, center, 0));
        this.dots.push(new SoundDot(radius, center, HALF_PI));
        this.dots.push(new SoundDot(radius, center, PI));
        _results.push(this.dots.push(new SoundDot(radius, center, THREEHALVES_PI)));
      }
      return _results;
    };

    World.prototype.update = function(ellapsedTime) {
      var dot, _i, _len, _ref, _results;

      _ref = this.dots;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        dot = _ref[_i];
        _results.push(dot.update(ellapsedTime));
      }
      return _results;
    };

    World.prototype.render = function(graphics) {
      var dot, _i, _len, _ref, _results;

      _ref = this.dots;
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        dot = _ref[_i];
        _results.push(dot.render(graphics));
      }
      return _results;
    };

    return World;

  })();

  $(function() {
    var canvas, clearContext, context, height, prevTime, update, width, world;

    width = window.innerWidth - 17;
    height = window.innerHeight - 17;
    $("<canvas width='" + width + "' height='" + height + "'>").appendTo(document.body);
    $('canvas').css({
      border: "1px solid black"
    });
    canvas = $('canvas')[0];
    context = canvas.getContext("2d");
    clearContext = function(context) {
      context.save();
      context.setTransform(1, 0, 0, 1, 0, 0);
      context.clearRect(0, 0, width, height);
      return context.restore();
    };
    world = new World(width, height);
    world.initialize();
    prevTime = new Date();
    update = function() {
      var currentTime, ellapsedTime;

      currentTime = new Date();
      ellapsedTime = currentTime - prevTime;
      prevTime = currentTime;
      world.update(ellapsedTime);
      clearContext(context);
      return world.render(context);
    };
    return window.setInterval(update, 10);
  });

}).call(this);
